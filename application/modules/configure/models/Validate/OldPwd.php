<?phpclass Configure_Model_Validate_OldPwd extends Zend_Validate_Abstract{	const MATCH_OLD_PWD = 'matchOldPwd';	protected $_messageTemplates = array( self::MATCH_OLD_PWD => 'ContraseÃ±a incorrecta' );	public function isValid($value, $context = null)	{		if( is_array($context) === true ){			$db 			  = Db_Db::conn();			$pwd 			  = $db->fetchOne('SELECT pwd FROM users WHERE users_id = ' . $db->quote(Zend_Auth::getInstance()->getStorage()->read()->users_id));			$additionalParams = Zend_Registry::get('additionalParams');			if( crypt($context['oldPwd'], $additionalParams['salt']) != $pwd ){				$this->_error(self::MATCH_OLD_PWD);				return false;			}		}		return true;	}}